# Home Assistant Integration: Новосибирскэнергосбыт

[![hacs_badge](https://img.shields.io/badge/HACS-Custom-orange.svg)](https://github.com/custom-components/hacs)

Неофициальная интеграция для Home Assistant, позволяющая отслеживать баланс, задолженность и показания счетчиков электроэнергии в АО «Новосибирскэнергосбыт».

## Возможности

*   Вывод текущей задолженности или баланса.
*   Отображение суммы к оплате.
*   Информация о лицевом счете и адресе.
*   Данные по счетчику: серийный номер, последние показания, дата подачи.
*   Дополнительные атрибуты: тариф, объем потребления, дата последнего платежа.
*   Автоматическое обновление данных каждые 30 минут.
*   Поддержка нескольких лицевых счетов (если они привязаны к одному логину).

## Установка

### Вариант 1: Через HACS (рекомендуется)

1.  Откройте **HACS** в Home Assistant.
2.  Перейдите в **Интеграции** -> Нажмите три точки справа сверху -> **Пользовательские репозитории**.
3.  Вставьте ссылку на этот репозиторий и выберите категорию **Интеграция**.
4.  Нажмите **Добавить**.
5.  Найдите "Новосибирскэнергосбыт" в поиске HACS и нажмите **Скачать**.
6.  Перезагрузите Home Assistant.

### Вариант 2: Вручную

1.  Скачайте архив репозитория или склонируйте его.
2.  Скопируйте папку `custom_components/nsk_sbyt` в директорию `/config/custom_components/` вашего Home Assistant.
3.  Перезагрузите Home Assistant.

## Настройка

1.  Зайдите в **Настройки** -> **Устройства и службы**.
2.  Нажмите кнопку **Добавить интеграцию**.
3.  В поиске введите **"Новосибирскэнергосбыт"**.
4.  Введите ваш **Логин** и **Пароль** от личного кабинета.
5.  Нажмите "Отправить".

## Сущности (Entity)

Интеграция создает сенсоры по одному на лицевой счет.

**Состояние (State):**
*   Текущая задолженность (в рублях).

**Атрибуты (Attributes):**
| Атрибут | Описание |
|----------|----------|
| Лицевой счет | Номер вашего лицевого счета |
| Адрес | Адрес регистрации |
| К оплате | Сумма текущего начисления |
| Номер счетчика | Серийный номер прибора учета |
| Последние показания | Числовое значение последнего показания |
| Дата показаний | Дата передачи последних показаний |
| Тариф | Актуальный тариф за кВт⋅ч |
| Объем потребления | Расчетный объем за период |
| Последний платеж | Сумма и дата последнего платежа |

## Автоматизации

### Пример: Уведомление в Telegram

```yaml
alias: "НСЭ: Еженедельный отчет"
trigger:
  - platform: time
    at: "10:00:00"
condition:
  - condition: time
    weekday: sun
action:
  - service: telegram_bot.send_message
    data:
      target: ВАШ_CHAT_ID
      message: >
        ⚡️ Отчет за неделю:
        Задолженность: {{ states('sensor.nsk_sbyt_XXXXX') }} ₽
        Потребление: {{ state_attr('sensor.nsk_sbyt_XXXXX', 'Объем потребления') }} кВт⋅ч
```

## Примечание

Данная интеграция является неофициальной и разрабатывается сообществом. Используйте на свой страх и риск.
